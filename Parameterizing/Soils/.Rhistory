Fire_Tolerance<-One_LUT$Fire_tol2
#length(OneSpecies)
if(length(OneSpecies)>2 & !is.null(nrow(OneSpecies))){
aliveY<-nrow(OneSpecies[OneSpecies[,2]=="Live"&OneSpecies[,3]<=Htat20,])
aliveY<-ifzerozero(aliveY)
alive20<-nrow(OneSpecies[OneSpecies[,2]=="Live"&OneSpecies[,3]>=Htat20&OneSpecies[,3]<HtatMat,])
alive20<-ifzerozero(alive20)
aliveM<-nrow(OneSpecies[OneSpecies[,2]=="Live"&OneSpecies[,3]>HtatMat,])
aliveM<-ifzerozero(aliveM)
deadY<-nrow(OneSpecies[OneSpecies[,2]=="Dead"&OneSpecies[,3]<=Htat20,])
deadY<-ifzerozero(deadY)
dead20<-nrow(OneSpecies[OneSpecies[,2]=="Dead"&OneSpecies[,3]>=Htat20&OneSpecies[,3]<HtatMat,])
dead20<-ifzerozero(dead20)
deadM<-nrow(OneSpecies[OneSpecies[,2]=="Dead"&OneSpecies[,3]>HtatMat,])
deadM<-ifzerozero(deadM)
percentdeadY<-deadY/(deadY+aliveY)
percentdead20<-dead20/(dead20+alive20)
percentdeadM<-deadM/(deadM+aliveM)
n=aliveY+alive20+aliveM+deadY+dead20+deadM
n<-ifzerozero(n)
ny<-aliveY+deadY
ny<-ifzerozero(ny)
n20<-alive20+dead20
n20<-ifzerozero(n20)
nM<-aliveM+deadM
nM<-ifzerozero(nM)
row<-cbind(S,n,ny,n20,nM,Fire_Tolerance,Htat20,HtatMat,aliveY,
deadY,percentdeadY,alive20,dead20,
percentdead20,aliveM,deadM,percentdeadM)
df<-rbind(row,df)
}
}
Duffdf<-as.data.frame(df)
Duffdf[,2]<-as.numeric(as.character(Duffdf[,2]))
#colnames(OneSpecies)
ff<-function(x){as.numeric(as.character(x))}
DuffDead<-aggregate(list(cony=ff(Duffdf$deadY),con20=ff(Duffdf$dead20),conm=ff(Duffdf$deadM)),by=list(Duffdf$Fire_Tolerance),
FUN=sum,na.rm=T)
Duffagg_count<-aggregate(list(pery=ff(Duffdf$ny),per20=ff(Duffdf$n20),perm=ff(Duffdf$nM)),by=list(Duffdf$Fire_Tolerance),
FUN=sum)
DuffDead$pery<-DuffDead$cony/Duffagg_count$pery
DuffDead$per20<-DuffDead$con20/Duffagg_count$per20
DuffDead$perm<-DuffDead$conm/Duffagg_count$perm
ff<-function(x){as.numeric(as.character(x))}
DuffDead<-aggregate(list(cony=ff(Duffdf$deadY),con20=ff(Duffdf$dead20),conm=ff(Duffdf$deadM)),by=list(Duffdf$Fire_Tolerance),
FUN=sum,na.rm=T)
Duffagg_count<-aggregate(list(pery=ff(Duffdf$ny),per20=ff(Duffdf$n20),perm=ff(Duffdf$nM)),by=list(Duffdf$Fire_Tolerance),
FUN=sum)
DuffDead$pery<-DuffDead$cony/Duffagg_count$pery
DuffDead$per20<-DuffDead$con20/Duffagg_count$per20
DuffDead$perm<-DuffDead$conm/Duffagg_count$perm
DuffConsumptionTerms<-c('Duff consumption','Duff consumption, Fire damaged', 'Duff consumption, Fire damaged, Tree declining','Duff consumption, Fire mortality','Duff consumption, Leaning tree, Tree declining',' Duff consumption, New mortality','Duff consumption, Root sprouts ','Duff consumption, Shares base with smaller tree(s)',"Duff consumption, Tree declining ")
NoDuff<-Burned[!Burned$Notes17 %in% DuffConsumptionTerms,]
NoDuff$GNSSPP[NoDuff$GNSSPP=="Oxdendrum \tarboreum"]<-"Oxydendrum arboreum"
Sp<-as.character(unique(NoDuff$GNSSPP))
#print(Sp)
#Burned$STAT19,by=list(Burned,)
NoDuff<-NoDuff[-1,]
Counts<- data.frame(Name=NoDuff$GNSSPP,Status=NoDuff$STAT19,
Ht=as.numeric(as.character(NoDuff$Ht)))
df<-NULL
#Sp
for(S in Sp){
#print(S)
OneSpecies<-Counts[Counts[,1]==S,]
OneSpecies<-OneSpecies[complete.cases(OneSpecies),]
One_LUT<-Sp_LUT[Sp_LUT$Genus.sp==S,]
Htat20<-One_LUT$Ht.at.20.yr*0.3048
HtatMat<-One_LUT$Ht.at.maturity*0.3048
Fire_Tolerance<-One_LUT$Fire_tol2
#length(OneSpecies)
if(length(OneSpecies)>2 & !is.null(nrow(OneSpecies))){
aliveY<-nrow(OneSpecies[OneSpecies[,2]=="Live"&OneSpecies[,3]<=Htat20,])
aliveY<-ifzerozero(aliveY)
alive20<-nrow(OneSpecies[OneSpecies[,2]=="Live"&OneSpecies[,3]>=Htat20&OneSpecies[,3]<HtatMat,])
alive20<-ifzerozero(alive20)
aliveM<-nrow(OneSpecies[OneSpecies[,2]=="Live"&OneSpecies[,3]>HtatMat,])
aliveM<-ifzerozero(aliveM)
deadY<-nrow(OneSpecies[OneSpecies[,2]=="Dead"&OneSpecies[,3]<=Htat20,])
deadY<-ifzerozero(deadY)
dead20<-nrow(OneSpecies[OneSpecies[,2]=="Dead"&OneSpecies[,3]>=Htat20&OneSpecies[,3]<HtatMat,])
dead20<-ifzerozero(dead20)
deadM<-nrow(OneSpecies[OneSpecies[,2]=="Dead"&OneSpecies[,3]>HtatMat,])
deadM<-ifzerozero(deadM)
percentdeadY<-deadY/(deadY+aliveY)
percentdead20<-dead20/(dead20+alive20)
percentdeadM<-deadM/(deadM+aliveM)
n=aliveY+alive20+aliveM+deadY+dead20+deadM
n<-ifzerozero(n)
ny<-aliveY+deadY
ny<-ifzerozero(ny)
n20<-alive20+dead20
n20<-ifzerozero(n20)
nM<-aliveM+deadM
nM<-ifzerozero(nM)
row<-cbind(S,n,ny,n20,nM,Fire_Tolerance,Htat20,HtatMat,aliveY,
deadY,percentdeadY,alive20,dead20,
percentdead20,aliveM,deadM,percentdeadM)
df<-rbind(row,df)
}
}
Nodf<-as.data.frame(Nodf)
Nodf<-as.data.frame(df)
Nodf[,2]<-as.numeric(as.character(Nodf[,2]))
ff<-function(x){as.numeric(as.character(x))}
NoDead<-aggregate(list(cony=ff(Nodf$deadY),con20=ff(Nodf$dead20),conm=ff(Nodf$deadM)),by=list(Nodf$Fire_Tolerance),
FUN=sum,na.rm=T)
Noagg_count<-aggregate(list(pery=ff(Nodf$ny),per20=ff(Nodf$n20),perm=ff(Nodf$nM)),by=list(Nodf$Fire_Tolerance),
FUN=sum)
NoDead$pery<-NoDead$cony/Noagg_count$pery
NoDead$per20<-NoDead$con20/Noagg_count$per20
NoDead$perm<-NoDead$conm/Noagg_count$perm
xx<-barplot(c(NoDead$pery[4],NoDead$per20[4],NoDead$perm[4]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Fire Resistance Class 4",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[4],NoDead$per20[4],NoDead$perm[4]),
label = c(Noagg_count$pery[4],Noagg_count$per20[4],Noagg_count$perm[4]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Fire Resistance Class 4",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),
label = c(Noagg_count$pery[5],Noagg_count$per20[4],Noagg_count$perm[5]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Fire Resistance Class 5",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),
label = c(Noagg_count$pery[5],Noagg_count$per20[4],Noagg_count$perm[5]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[5],DuffDead$per20[5],DuffDead$perm[5]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Fire Resistance Class 5",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[5],DuffDead$per20[5],DuffDead$perm[5]),
label = c(Duffagg_count$pery[5],Duffagg_count$per20[4],Duffagg_count$perm[5]), pos = 3, cex = .8, col = "red")
View(DuffDead)
xx<-barplot(c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Fire Resistance Class 5",ylim=c(0,.3))
xx<-barplot(c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Fire Resistance Class 5",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),
label = c(Noagg_count$pery[5],Noagg_count$per20[4],Noagg_count$perm[5]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Fire Resistance Class 5",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),
label = c(Duffagg_count$pery[4],Duffagg_count$per20[4],Duffagg_count$perm[4]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Fire Resistance Class 5",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),
label = c(Noagg_count$pery[5],Noagg_count$per20[4],Noagg_count$perm[5]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption Class 5",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),
label = c(Duffagg_count$pery[4],Duffagg_count$per20[4],Duffagg_count$perm[4]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff Fire Resistance Class 5",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),
label = c(Noagg_count$pery[5],Noagg_count$per20[4],Noagg_count$perm[5]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption Class 5",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),
label = c(Duffagg_count$pery[4],Duffagg_count$per20[4],Duffagg_count$perm[4]), pos = 3, cex = .8, col = "red")
par(mfrow(2,1))
par(mfrow=c(2,1))
xx<-barplot(c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff Fire Resistance Class 5",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),
label = c(Noagg_count$pery[5],Noagg_count$per20[4],Noagg_count$perm[5]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption Class 5",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),
label = c(Duffagg_count$pery[4],Duffagg_count$per20[4],Duffagg_count$perm[4]), pos = 3, cex = .8, col = "red")
par(mfrow=c(1,2))
xx<-barplot(c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff Fire Resistance Class 5",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),
label = c(Noagg_count$pery[5],Noagg_count$per20[4],Noagg_count$perm[5]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption Class 5",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),
label = c(Duffagg_count$pery[4],Duffagg_count$per20[4],Duffagg_count$perm[4]), pos = 3, cex = .8, col = "red")
par(mfrow=c(1,2))
xx<-barplot(c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff Fire Resistance Class 5",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),
label = c(Noagg_count$pery[5],Noagg_count$per20[4],Noagg_count$perm[5]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption Class 5",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),
label = c(Duffagg_count$pery[4],Duffagg_count$per20[4],Duffagg_count$perm[4]), pos = 3, cex = .8, col = "red")
par(mfrow=c(1,2))
xx<-barplot(c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff Fire Resistance Class 5",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),
label = c(Noagg_count$pery[5],Noagg_count$per20[4],Noagg_count$perm[5]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption Class 5",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),
label = c(Duffagg_count$pery[4],Duffagg_count$per20[4],Duffagg_count$perm[4]), pos = 3, cex = .8, col = "red")
par(mfrow=c(1,2))
xx<-barplot(c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff Fire Resistance (Class 5)",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[5],NoDead$per20[5],NoDead$perm[5]),
label = c(Noagg_count$pery[5],Noagg_count$per20[4],Noagg_count$perm[5]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption (Class 5)",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[4],DuffDead$per20[4],DuffDead$perm[4]),
label = c(Duffagg_count$pery[4],Duffagg_count$per20[4],Duffagg_count$perm[4]), pos = 3, cex = .8, col = "red")
par(mfrow=c(1,2))
xx<-barplot(c(NoDead$pery[4],NoDead$per20[4],NoDead$perm[4]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff (Class 4)",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[4],NoDead$per20[4],NoDead$perm[5]),
label = c(Noagg_count$pery[4],Noagg_count$per20[4],Noagg_count$perm[4]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[3],DuffDead$per20[3],DuffDead$perm[3]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption (Class 5)",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[3],DuffDead$per20[3],DuffDead$perm[3]),
label = c(Duffagg_count$pery[3],Duffagg_count$per20[3],Duffagg_count$perm[3]), pos = 3, cex = .8, col = "red")
par(mfrow=c(1,2))
xx<-barplot(c(NoDead$pery[4],NoDead$per20[4],NoDead$perm[4]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff (Class 4)",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[4],NoDead$per20[4],NoDead$perm[4]),
label = c(Noagg_count$pery[4],Noagg_count$per20[4],Noagg_count$perm[4]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[3],DuffDead$per20[3],DuffDead$perm[3]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption (Class 5)",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[3],DuffDead$per20[3],DuffDead$perm[3]),
label = c(Duffagg_count$pery[3],Duffagg_count$per20[3],Duffagg_count$perm[3]), pos = 3, cex = .8, col = "red")
par(mfrow=c(1,2))
xx<-barplot(c(NoDead$pery[4],NoDead$per20[4],NoDead$perm[4]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff (Class 4)",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[4],NoDead$per20[4],NoDead$perm[4]),
label = c(Noagg_count$pery[4],Noagg_count$per20[4],Noagg_count$perm[4]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[3],DuffDead$per20[3],DuffDead$perm[3]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption (Class 4)",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[3],DuffDead$per20[3],DuffDead$perm[3]),
label = c(Duffagg_count$pery[3],Duffagg_count$per20[3],Duffagg_count$perm[3]), pos = 3, cex = .8, col = "red")
ff<-function(x){as.numeric(as.character(x))}
DuffDead<-aggregate(list(cony=ff(Duffdf$deadY),con20=ff(Duffdf$dead20),conm=ff(Duffdf$deadM)),by=list(Duffdf$Fire_Tolerance),
FUN=sum,na.rm=T)
Duffagg_count<-aggregate(list(pery=ff(Duffdf$ny),per20=ff(Duffdf$n20),perm=ff(Duffdf$nM)),by=list(Duffdf$Fire_Tolerance),
FUN=sum)
DuffDead$pery<-DuffDead$cony/Duffagg_count$pery
DuffDead$per20<-DuffDead$con20/Duffagg_count$per20
DuffDead$perm<-DuffDead$conm/Duffagg_count$perm
ff<-function(x){as.numeric(as.character(x))}
NoDead<-aggregate(list(cony=ff(Nodf$deadY),con20=ff(Nodf$dead20),conm=ff(Nodf$deadM)),by=list(Nodf$Fire_Tolerance),
FUN=sum,na.rm=T)
Noagg_count<-aggregate(list(pery=ff(Nodf$ny),per20=ff(Nodf$n20),perm=ff(Nodf$nM)),by=list(Nodf$Fire_Tolerance),
FUN=sum)
NoDead$pery<-NoDead$cony/Noagg_count$pery
NoDead$per20<-NoDead$con20/Noagg_count$per20
NoDead$perm<-NoDead$conm/Noagg_count$perm
par(mfrow=c(1,2))
xx<-barplot(c(NoDead$pery[4],NoDead$per20[4],NoDead$perm[4]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff (Class 4)",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[4],NoDead$per20[4],NoDead$perm[4]),
label = c(Noagg_count$pery[4],Noagg_count$per20[4],Noagg_count$perm[4]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[3],DuffDead$per20[3],DuffDead$perm[3]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption (Class 4)",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[3],DuffDead$per20[3],DuffDead$perm[3]),
label = c(Duffagg_count$pery[3],Duffagg_count$per20[3],Duffagg_count$perm[3]), pos = 3, cex = .8, col = "red")
par(mfrow=c(1,2))
xx<-barplot(c(NoDead$pery[3],NoDead$per20[3],NoDead$perm[3]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff (Class 4)",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[3],NoDead$per20[3],NoDead$perm[3]),
label = c(Noagg_count$pery[3],Noagg_count$per20[3],Noagg_count$perm[3]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[2],DuffDead$per20[2],DuffDead$perm[2]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption (Class 4)",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[2],DuffDead$per20[2],DuffDead$perm[2]),
label = c(Duffagg_count$pery[2],Duffagg_count$per202[2],Duffagg_count$perm[2]), pos = 3, cex = .8, col = "red")
#table(Burned$Notes17)
DuffConsumptionTerms<-c('Duff consumption','Duff consumption, Fire damaged', 'Duff consumption, Fire damaged, Tree declining','Duff consumption, Fire mortality','Duff consumption, Leaning tree, Tree declining',' Duff consumption, New mortality','Duff consumption, Root sprouts ','Duff consumption, Shares base with smaller tree(s)',"Duff consumption, Tree declining ")
Duff<-Burned[Burned$Notes17 %in% DuffConsumptionTerms,]
Duff$GNSSPP[Duff$GNSSPP=="Oxdendrum \tarboreum"]<-"Oxydendrum arboreum"
Sp<-as.character(unique(Duff$GNSSPP))
#print(Sp)
#Burned$STAT19,by=list(Burned,)
Duff<-NoDuff[-1,]
Counts<- data.frame(Name=Duff$GNSSPP,Status=Duff$STAT19,
Ht=as.numeric(as.character(Duff$Ht)))
df<-NULL
#Sp
for(S in Sp){
#print(S)
OneSpecies<-Counts[Counts[,1]==S,]
OneSpecies<-OneSpecies[complete.cases(OneSpecies),]
One_LUT<-Sp_LUT[Sp_LUT$Genus.sp==S,]
Htat20<-One_LUT$Ht.at.20.yr*0.3048
HtatMat<-One_LUT$Ht.at.maturity*0.3048
Fire_Tolerance<-One_LUT$Fire_tol2
#length(OneSpecies)
if(length(OneSpecies)>2 & !is.null(nrow(OneSpecies))){
aliveY<-nrow(OneSpecies[OneSpecies[,2]=="Live"&OneSpecies[,3]<=Htat20,])
aliveY<-ifzerozero(aliveY)
alive20<-nrow(OneSpecies[OneSpecies[,2]=="Live"&OneSpecies[,3]>=Htat20&OneSpecies[,3]<HtatMat,])
alive20<-ifzerozero(alive20)
aliveM<-nrow(OneSpecies[OneSpecies[,2]=="Live"&OneSpecies[,3]>HtatMat,])
aliveM<-ifzerozero(aliveM)
deadY<-nrow(OneSpecies[OneSpecies[,2]=="Dead"&OneSpecies[,3]<=Htat20,])
deadY<-ifzerozero(deadY)
dead20<-nrow(OneSpecies[OneSpecies[,2]=="Dead"&OneSpecies[,3]>=Htat20&OneSpecies[,3]<HtatMat,])
dead20<-ifzerozero(dead20)
deadM<-nrow(OneSpecies[OneSpecies[,2]=="Dead"&OneSpecies[,3]>HtatMat,])
deadM<-ifzerozero(deadM)
percentdeadY<-deadY/(deadY+aliveY)
percentdead20<-dead20/(dead20+alive20)
percentdeadM<-deadM/(deadM+aliveM)
n=aliveY+alive20+aliveM+deadY+dead20+deadM
n<-ifzerozero(n)
ny<-aliveY+deadY
ny<-ifzerozero(ny)
n20<-alive20+dead20
n20<-ifzerozero(n20)
nM<-aliveM+deadM
nM<-ifzerozero(nM)
row<-cbind(S,n,ny,n20,nM,Fire_Tolerance,Htat20,HtatMat,aliveY,
deadY,percentdeadY,alive20,dead20,
percentdead20,aliveM,deadM,percentdeadM)
df<-rbind(row,df)
}
}
Duffdf<-as.data.frame(df)
Duffdf[,2]<-as.numeric(as.character(Duffdf[,2]))
#colnames(OneSpecies)
ff<-function(x){as.numeric(as.character(x))}
DuffDead<-aggregate(list(cony=ff(Duffdf$deadY),con20=ff(Duffdf$dead20),conm=ff(Duffdf$deadM)),by=list(Duffdf$Fire_Tolerance),
FUN=sum,na.rm=T)
Duffagg_count<-aggregate(list(pery=ff(Duffdf$ny),per20=ff(Duffdf$n20),perm=ff(Duffdf$nM)),by=list(Duffdf$Fire_Tolerance),
FUN=sum)
DuffDead$pery<-DuffDead$cony/Duffagg_count$pery
DuffDead$per20<-DuffDead$con20/Duffagg_count$per20
DuffDead$perm<-DuffDead$conm/Duffagg_count$perm
View(Duffagg_count)
View(NoDuff)
View(Noagg_count)
par(mfrow=c(1,2))
xx<-barplot(c(NoDead$pery[3],NoDead$per20[3],NoDead$perm[3]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff (Class 4)",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[3],NoDead$per20[3],NoDead$perm[3]),
label = c(Noagg_count$pery[3],Noagg_count$per20[3],Noagg_count$perm[3]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[2],DuffDead$per20[2],DuffDead$perm[2]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption (Class 4)",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[2],DuffDead$per20[2],DuffDead$perm[2]),
label = c(Duffagg_count$pery[2],Duffagg_count$per202[2],Duffagg_count$perm[2]), pos = 3, cex = .8, col = "red")
par(mfrow=c(1,2))
xx<-barplot(c(NoDead$pery[3],NoDead$per20[3],NoDead$perm[3]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff (Class 3)",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[3],NoDead$per20[3],NoDead$perm[3]),
label = c(Noagg_count$pery[3],Noagg_count$per20[3],Noagg_count$perm[3]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[2],DuffDead$per20[2],DuffDead$perm[2]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption (Class 3)",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[2],DuffDead$per20[2],DuffDead$perm[2]),
label = c(Duffagg_count$pery[2],Duffagg_count$per202[2],Duffagg_count$perm[2]), pos = 3, cex = .8, col = "red")
par(mfrow=c(1,2))
xx<-barplot(c(NoDead$pery[1],NoDead$per20[1],NoDead$perm[1]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff (Class 4)",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[1],NoDead$per20[1],NoDead$perm[1]),
label = c(Noagg_count$pery[1],Noagg_count$per20[1],Noagg_count$perm[1]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[1],DuffDead$per20[1],DuffDead$perm[1]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption (Class 4)",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[1],DuffDead$per20[1],DuffDead$perm[1]),
label = c(Duffagg_count$pery[1],Duffagg_count$per20[1],Duffagg_count$perm[1]), pos = 3, cex = .8, col = "red")
par(mfrow=c(1,2))
xx<-barplot(c(NoDead$pery[1],NoDead$per20[1],NoDead$perm[1]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="No Duff (Class 1)",ylim=c(0,.3))
text(x = xx, y = c(NoDead$pery[1],NoDead$per20[1],NoDead$perm[1]),
label = c(Noagg_count$pery[1],Noagg_count$per20[1],Noagg_count$perm[1]), pos = 3, cex = .8, col = "red")
xx<-barplot(c(DuffDead$pery[1],DuffDead$per20[1],DuffDead$perm[1]),names.arg=c("0-20 years","20-Maturity","Maturity"),las=2,
main="Duff Consumption (Class 1)",ylim=c(0,.3))
text(x = xx, y = c(DuffDead$pery[1],DuffDead$per20[1],DuffDead$perm[1]),
label = c(Duffagg_count$pery[1],Duffagg_count$per20[1],Duffagg_count$perm[1]), pos = 3, cex = .8, col = "red")
Class5R<-BarkThickness$Genus_Species[BarkThickness$BT_coef>.044 & BarkThickness$BT_coef<.05]
Class4R<-BarkThickness$Genus_Species[BarkThickness$BT_coef>.039 & BarkThickness$BT_coef<=.044]
Class3R<-BarkThickness$Genus_Species[BarkThickness$BT_coef>.035 & BarkThickness$BT_coef<=.039]
Class2R<-BarkThickness$Genus_Species[BarkThickness$BT_coef>.030 & BarkThickness$BT_coef<=.035]
Class1R<-BarkThickness$Genus_Species[BarkThickness$BT_coef>.025 & BarkThickness$BT_coef<=.030]
Sp_LUT$Fire_tol2[Sp_LUT$Genus.sp %in% Class5R]<-5
Sp_LUT$Fire_tol2[Sp_LUT$Genus.sp %in% Class4R]<-4
Sp_LUT$Fire_tol2[Sp_LUT$Genus.sp %in% Class3R]<-3
Sp_LUT$Fire_tol2[Sp_LUT$Genus.sp %in% Class2R]<-2
Sp_LUT$Fire_tol2[Sp_LUT$Genus.sp %in% Class1R]<-1
View(Burned)
View(df)
Burned<-WithDuff[WithDuff$TRT=='Burned',]
BarkRatio<-read.csv(paste0(Mort_Drive,"Harmon_84_Bark.csv"))
Sp_LUT$Genus.sp[Sp_LUT$Genus.sp %in% BarkRatio$Genus.sp]
Sp_LUT2<-merge(Sp_LUT,BarkRatio,by="Genus.sp",all.x=T)
Sp_LUT2$B0[Sp_LUT2$Genus=="Carya"]<-.003
Sp_LUT2$B1[Sp_LUT2$Genus=="Carya"]<-0.04
Sp_LUT2$B2[Sp_LUT2$Genus=="Carya"]<-0.00
NoDuff<-Burned
NoDuff$GNSSPP[NoDuff$GNSSPP=="Oxdendrum \tarboreum"]<-"Oxydendrum arboreum"
Sp<-as.character(unique(NoDuff$GNSSPP))
#print(Sp)
#Burned$STAT19,by=list(Burned,)
NoDuff<-NoDuff[-1,]
Counts<- data.frame(Name=NoDuff$GNSSPP,Status=NoDuff$STAT19,
Ht=as.numeric(as.character(NoDuff$Ht)))
df<-NULL
#Sp
for(S in Sp){
#print(S)
OneSpecies<-Counts[Counts[,1]==S,]
OneSpecies<-OneSpecies[complete.cases(OneSpecies),]
One_LUT<-Sp_LUT[Sp_LUT$Genus.sp==S,]
Htat20<-One_LUT$Ht.at.20.yr*0.3048
HtatMat<-One_LUT$Ht.at.maturity*0.3048
Fire_Tolerance<-One_LUT$Fire_tol2
#length(OneSpecies)
if(length(OneSpecies)>2 & !is.null(nrow(OneSpecies))){
aliveY<-nrow(OneSpecies[OneSpecies[,2]=="Live"&OneSpecies[,3]<=Htat20,])
aliveY<-ifzerozero(aliveY)
alive20<-nrow(OneSpecies[OneSpecies[,2]=="Live"&OneSpecies[,3]>=Htat20&OneSpecies[,3]<HtatMat,])
alive20<-ifzerozero(alive20)
aliveM<-nrow(OneSpecies[OneSpecies[,2]=="Live"&OneSpecies[,3]>HtatMat,])
aliveM<-ifzerozero(aliveM)
deadY<-nrow(OneSpecies[OneSpecies[,2]=="Dead"&OneSpecies[,3]<=Htat20,])
deadY<-ifzerozero(deadY)
dead20<-nrow(OneSpecies[OneSpecies[,2]=="Dead"&OneSpecies[,3]>=Htat20&OneSpecies[,3]<HtatMat,])
dead20<-ifzerozero(dead20)
deadM<-nrow(OneSpecies[OneSpecies[,2]=="Dead"&OneSpecies[,3]>HtatMat,])
deadM<-ifzerozero(deadM)
percentdeadY<-deadY/(deadY+aliveY)
percentdead20<-dead20/(dead20+alive20)
percentdeadM<-deadM/(deadM+aliveM)
n=aliveY+alive20+aliveM+deadY+dead20+deadM
n<-ifzerozero(n)
ny<-aliveY+deadY
ny<-ifzerozero(ny)
n20<-alive20+dead20
n20<-ifzerozero(n20)
nM<-aliveM+deadM
nM<-ifzerozero(nM)
row<-cbind(S,n,ny,n20,nM,Fire_Tolerance,Htat20,HtatMat,aliveY,
deadY,percentdeadY,alive20,dead20,
percentdead20,aliveM,deadM,percentdeadM)
df<-rbind(row,df)
}
}
df<-as.data.frame(df)
df[,2]<-as.numeric(as.character(df[,2]))
#colnames(OneSpecies)
View(df)
DNBRmap<-raster("C:/Users/zacha/Desktop/Sapps_Mortality/sapps_delayed_mortality-20200831T165837Z-001/sapps_delayed_mortality/delayed_rdnbr.tif)
DNBRmap<-raster("C:/Users/zacha/Desktop/Sapps_Mortality/sapps_delayed_mortality-20200831T165837Z-001/sapps_delayed_mortality/delayed_rdnbr.tif')
DNBRmap<-raster("C:/Users/zacha/Desktop/Sapps_Mortality/sapps_delayed_mortality-20200831T165837Z-001/sapps_delayed_mortality/delayed_rdnbr.tif')
DNBRmap<-raster("C:/Users/zacha/Desktop/Sapps_Mortality/sapps_delayed_mortality-20200831T165837Z-001/sapps_delayed_mortality/delayed_rdnbr.tif")
DNBRmap<-raster("C:/Users/zacha/Desktop/Sapps_Mortality/sapps_delayed_mortality-20200831T165837Z-001/sapps_delayed_mortality/delayed_rdnbr.tif")
colnames(PlotLocations)
plotsshort<-PlotLocations[c('Plot.ID','Latitude','Longitude')]
plotsshort<-as.data.frame(PlotLocations[c('Plot.ID','Latitude','Longitude')])
names(plotsshort)<-c("Plot.ID","x","y")
SpatialPoints(plotsshort)
View(plotsshort)
SpatialPoints(as.matrx(plotsshort[,2:3]))
SpatialPoints(as.matrix(plotsshort[,2:3]))
points<-SpatialPoints(as.matrix(plotsshort[,2:3]))
DNBRscore<-extract(DNBRmap,points)
DNBRscore<-extract(DNBRmap,points,sp=T)
points<-SpatialPoints(as.matrix(plotsshort[,2:3]))
DNBRscore<-extract(DNBRmap,points,sp=T)
DNBRscore<-raster::extract(DNBRmap,points,sp=T)
View(DNBRscore)
points<-SpatialPoints(as.matrix(plotsshort[,2:3]))
View(points)
crs(points)
crs(points)<-- CRS("+init=epsg:4326")
crs(points)<- CRS("+init=epsg:4326")
crs(points)
crs(DNBRscore)
projeciton(DNBRmap)
projection(DNBRmap)
points_repro<-reproject(points,projection(DNBRmap))
points_repro<-spTransform(points,projection(DNBRmap))
DNBRscore<-raster::extract(DNBRmap,points,sp=T)
DNBRscore<-raster::extract(DNBRmap,points_repro,sp=T)
View(DNBRscore)
DNBRscore@data[["delayed_rdnbr"]]
DNBRscore<-raster::extract(DNBRmap,points,sp=T)
View(DNBRscore)
plot(DNBRscore)
plot(poionts_repro,add=T)
plot(DNBRscore)
plot(DNBRmap)
plot(DNBRmap)
plot(points_repro,add=T)
plot(points_repro,add=T)
plot(points_reproT)
plot(points_repro)
plot(points_repro,axes=T)
crs(points)<- CRS("+init=epsg:4326")
plot(points)
plot(points,axes=T)
View(PlotLocations)
points<-SpatialPoints(as.matrix(plotsshort[,3:2]))
crs(points)<- CRS("+init=epsg:4326")
points_repro<-spTransform(points,projection(DNBRmap))
DNBRscore<-raster::extract(DNBRmap,points,sp=T)
plot(points,axes=T)
plot(points_repro,axes=T)
plot(DNBRmap)
plot(DNBRmap,ylim=c(1370000,1410000))
plot(DNBRmap,ylim=c(1370000,1410000),xlim=c(1020000,1140000))
plot(DNBRmap,ylim=c(1370000,1410000),xlim=c(1020000,1140000))
plot(DNBRmap,ylim=c(1370000,1410000),xlim=c(1020000,1140000))
plot(points_repro,add=T)
DNBRscore<-raster::extract(DNBRmap,points_repro,sp=T)
View(DNBRscore)
View(DNBRscore)
as.data.frame(DNBRscore)
pointsaspoints<-as.data.frame(DNBRscore)
PlotLocations$DNBR<-pointsaspoints$delayed_rdnbr
View(PlotLocations)
Burned<-PlotLocations[PlotLocations$Treatment=="Burned",]
UnBurned<-PlotLocations[PlotLocations$Treatment=="Unburned",]
vioplot(Burned$DNBR,UnBurned$DNBR,names=c("Burned","Unburned"),col=c('#4285F4','#DB4437'),lwd=2.0,main="Duff cm burned vs Unburned")
View(plot_tolerance)
View(PlotLocations)
plot(DNBRmap,ylim=c(1370000,1410000),xlim=c(1020000,1140000))
plot(points_repro,add=T)
